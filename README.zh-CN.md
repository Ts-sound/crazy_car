[English](README.md) | [中文](README.zh-CN.md)

# Crazy Car 🚗

一款有趣且刺激的 HTML5 浏览器驾驶游戏，包含多种关卡、道具和策略性玩法！

## 🎮 游戏概述

Crazy Car 是一款快节奏的街机驾驶游戏，玩家需要在车流中穿梭、收集道具，并挑战越来越难的关卡。躲避障碍物、最大化得分，测试你的反应速度和策略思维！

## ✨ 游戏特性

### 🎯 三关卡递进系统

- **第一关：新手** (0-1000 分)
    - 灰色沥青路面
    - 基础速度，适中障碍物频率
    - 适合学习基本操作

- **第二关：中级** (1000-3000 分)
    - 沙漠主题沙色路面
    - 速度提升 20%
    - 障碍物密度增加
    - 升级动画效果

- **第三关：专家** (3000 分以上)
    - 霓虹紫色路面，带发光效果
    - 速度提升 40%
    - 最大障碍物密度
    - 技术娴熟玩家的终极挑战

### ⚡ 五种道具

| 道具 | 效果 | 持续时间 |
|------|------|---------|
| 🛡️ **护盾** | 无敌 - 安全穿过障碍物 | 5 秒 |
| ⏰ **慢动作** | 障碍物移动速度降低 50% | 5 秒 |
| 🧲 **磁铁** | 吸引附近金币 | 5 秒 |
| 2x **双倍分数** | 所有得分翻倍 | 8 秒 |
| ❤️ **额外生命** | 立即增加一条生命 | 瞬间 |

### ❤️ 生命系统

- 初始 3 条生命
- 碰撞障碍物 = 失去 1 条生命
- 收集额外生命道具可增加生命
- 生命归零时游戏结束

### 🎨 视觉特性

- 每关动态路面主题
- 活跃道具显示，带进度条和倒计时
- 升级过渡动画
- 活跃道具视觉效果：
    - 护盾：车辆周围蓝色光环
    - 加速：车辆后方橙色尾迹
    - 磁铁：绿色虚线圆圈显示吸引范围
- 流畅 60fps 游戏体验

## 🕹️ 游戏玩法

### 操作方式

- **← → 方向键** 或 **A/D** - 切换车道
- **空格** 或 **回车** - 开始游戏 / 重新开始 / 暂停切换
- **P** 或 **ESC** - 暂停 / 继续

### 玩法说明

1. 按空格或回车键开始
2. 使用方向键躲避迎面而来的车辆
3. 收集金币获得额外分数（每个 +100 分）
4. 获取道具获得战略优势
5. 尽可能长时间生存以增加分数
6. 达到分数阈值进入更高级别
7. 打破你的最高分！

### 计分系统

- **每帧 +1 分** 生存得分
- **+10 分** 每个躲避的障碍物
- **+100 分** 每个收集的金币
- 双倍分数激活时应用得分倍增器

## 🚀 快速开始

### 前置要求

- 现代网页浏览器（Chrome、Firefox、Safari、Edge）
- 无需安装！

### 运行游戏

**方式一：使用预构建的单文件**

```bash
# 打开构建好的单文件版本
open dist/index.html  # macOS
start dist/index.html # Windows
xdg-open dist/index.html # Linux
```

**方式二：自行构建**

```bash
# 安装依赖
npm install

# 构建单文件 HTML
npm run build

# 在浏览器中打开 dist/index.html
```

**方式三：开发模式**

```bash
npm run dev      # 启动开发服务器，支持热重载
npm run test     # 运行单元测试
```

## 📊 游戏机制

### 关卡递进

- 达到分数阈值后自动解锁新关卡
- 每个关卡有独特的视觉主题和递增的难度
- 升级时显示升级画面

### 道具策略

- **护盾**：被障碍物包围或在危急时刻使用
- **慢动作**：躲避密集车流的完美选择
- **磁铁**：与双倍分数结合实现大量金币收集
- **双倍分数**：接近大量金币或障碍物时激活
- **额外生命**：获得时立即收集作为安全保障

### 障碍物模式

- 障碍物在 3 个车道随机生成
- 生成频率随关卡递进增加
- 障碍物在更高级别移动更快
- 战略性使用道具穿越困难模式

## 🧪 测试

```bash
# 运行测试
npm test

# 单次运行测试
npm run test:run
```

单元测试覆盖：
- EventBus（发布/订阅）
- ObjectPool（获取/释放）
- Collision 检测（AABB）
- PowerUpManager（效果、计时器）
- Player 移动
- Entity 基类

## 🛠️ 技术细节

- **语言**：HTML5、CSS3、JavaScript (ES6+)
- **渲染**：HTML5 Canvas API
- **性能**：使用 requestAnimationFrame 实现 60fps 游戏循环
- **存储**：localStorage 持久化最高分
- **依赖**：无（独立 HTML 文件）

### 游戏架构

```
游戏循环 (60fps)
├── 输入处理
├── 状态更新
│   ├── Player 移动
│   ├── 障碍物生成与移动
│   ├── 道具生成与效果
│   ├── 碰撞检测
│   └── 关卡递进
└── 渲染
    ├── 路面与环境
    ├── Player 与车辆
    ├── 道具与效果
    └── UI 覆盖
```

## 📁 项目结构

```
crazy_car/
├── src/                    # 源代码
│   ├── core/              # 核心系统 (Game, Input, EventBus)
│   ├── entities/          # 游戏实体 (Player, Enemy, Coin 等)
│   ├── systems/           # 游戏系统 (Rendering, Collision 等)
│   ├── utils/             # 工具类 (ObjectPool)
│   ├── constants.js       # 游戏配置
│   ├── main.js            # 入口文件
│   ├── index.html         # HTML 文件
│   └── style.css          # 样式
├── tests/                  # 单元测试
├── config/                 # 构建配置
│   ├── vite.config.js
│   └── vitest.config.js
├── scripts/                # 自动化脚本
│   ├── build.sh           # 构建项目
│   ├── test.sh            # 运行测试
│   └── release.sh         # 创建发布
├── docs/                   # 文档
│   ├── plans/             # 设计文档
│   └── sessions/          # 会话记录
├── dist/                   # 构建产物
├── .editorconfig           # 代码风格
├── CHANGELOG.md            # 版本历史
├── package.json
└── README.md
```

## 🛠️ 开发指南

### 设置

```bash
# 安装依赖
npm install

# 运行开发服务器
npm run dev

# 运行测试
npm run test

# 生产环境构建
npm run build
```

### 脚本

```bash
./scripts/build.sh      # 构建单文件 HTML
./scripts/test.sh       # 运行所有测试
./scripts/release.sh v1.0.1  # 创建新版本
```

## 🚀 CI/CD

GitHub Actions 在 tagged commits 时自动构建和创建发布：

```bash
# 创建发布
git tag v1.0.0
git push origin v1.0.0

# 触发流程：测试 → 构建 → GitHub Release（附带 dist/index.html）
```

## 📄 许可证

本项目是开源的，根据 LICENSE 文件的条款提供。

## 🤝 贡献

欢迎贡献！你可以：
- 报告错误
- 建议新功能
- 提交 Pull Request
- 改进文档

## 🎮 享受游戏！

祝你游戏愉快！尝试打破你的最高分并达到专家级别！🏆

---

**版本**: 1.0.0  
**最后更新**: 2026-02-27  
**状态**: ✅ 完成且功能完整  
**测试**: ✅ 67 个测试通过
